<div class="shop-page-bar">
    <div class="container-fluid">
        <nav class="woocommerce-breadcrumb breadcrumbs">
            <a routerLink="/">Home</a>
            <a routerLink="/checkout" routerLinkActive="active">Checkout</a>
        </nav>
        <div class="page-bar-right"></div>
    </div>
</div>
<form [formGroup]="checkoutForm">
    <div id="Checkout-Send" class="Checkout-Send" *ngIf="!showPayment && !successOrderId">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-6 col-md-12 mb-4" *ngIf="!noShippingCharge">
                    <div class="sendgift-btn d-flex">
                        <button class="btn1" [ngClass]="{'active': isDelivery === true}">
                            <a type="button" [ngClass]="{'active': isDelivery === true}"
                               (click)='showDelivarySection()'>Delivery</a>
                        </button>
                    </div>
                    <div class="Checkout-from1" *ngIf='isDelivery'>
                        <p>Shipping Address</p>

                        <div class="form-row" *ngIf="!newShippingAddress">
                            <div class="Checkout-from1">
                                <label>Select Address</label>
                                <mat-radio-group formControlName="shipping_id"
                                                 (change)="onAddressChange($event.value, 'shipping')">
                                    <div class="border-bottom radio2"
                                         *ngFor="let address of prevoius_address; let i = index">
                                        <mat-radio-button value="{{''+address.id}}">{{ address?.address }}
                                            ,{{ address?.division_id.name }},{{address?.upazila_id.name}}
                                            ,{{ address?.zila_id.name }}.
                                        </mat-radio-button>
                                    </div>
                                </mat-radio-group>
                            </div>
                        </div>

                        <div class="row send-btn1 mb-2">
                            <button (click)="onAddressToggle($event, 'shipping')">
                                <a *ngIf="!newShippingAddress">New Shipping address</a>
                                <a *ngIf="newShippingAddress">Select from previous</a>
                            </button>
                        </div>

                        <div class="form-row" *ngIf="newShippingAddress">
                            <div class="form-group col-md-6">
                                <label>First Name</label>
                                <input type="text" class="form-control" formControlName="shippingFirstName"
                                       placeholder="Input First Name">
                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('shippingFirstName').dirty || showFormError) && getSignUpFormControl('shippingFirstName').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>First name is required!
                                    </span>
                                    <span *ngIf="(getSignUpFormControl('shippingFirstName').dirty) && getSignUpFormControl('shippingFirstName').hasError('onlyName')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Only character is allowed!
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Last Name</label>
                                <input type="text" class="form-control" formControlName="shippingLastName"
                                       placeholder="Input Last Name">
<!--                                <div class="validation-feedback">-->
<!--                                    <span *ngIf="(getSignUpFormControl('shippingLastName').dirty || showFormError) && getSignUpFormControl('shippingLastName').hasError('required')">-->
<!--                                      <i class='fa fa-exclamation-circle mr-2'></i>Last name is required!-->
<!--                                    </span>-->
<!--                                    <span *ngIf="(getSignUpFormControl('shippingLastName').dirty) && getSignUpFormControl('shippingLastName').hasError('onlyName')">-->
<!--                                      <i class='fa fa-exclamation-circle mr-2'></i>Only character is allowed!-->
<!--                                    </span>-->
<!--                                </div>-->
                            </div>
                            <div class="form-group col-md-6">
                                <label>Phone Number</label>
                                <input type="text" class="form-control" formControlName="shippingPhone"
                                       placeholder="Enter your phone Number">

                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('shippingPhone').dirty || showFormError) && getSignUpFormControl('shippingPhone').hasError('required')">
                                        <i class='fa fa-exclamation-circle mr-2'></i>Phone Number is required!
                                    </span>
                                    <span *ngIf="(getSignUpFormControl('shippingPhone').dirty) && getSignUpFormControl('shippingPhone').hasError('phoneNumber')">
                                        <i class='fa fa-exclamation-circle mr-2'></i>Enter a right Phone Number!
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Select Division</label>
                                <select class="form-control" formControlName="shipping_division_id"
                                        (change)="divisionChange($event, 'shipping')">
                                    <option value="">Select Division</option>

                                    <option *ngFor="let division of divisionSearchOptions" value="{{division.id}}">
                                        {{division.name}}
                                    </option>
                                </select>
                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('shipping_division_id').dirty || showFormError) && getSignUpFormControl('shipping_division_id').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Division is required!
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Select Zila</label>
                                <select class="form-control" formControlName="shipping_zila_id"
                                        (change)="zilaChange($event, 'shipping')"
                                        (click)="checkAddressSegment('shipping', 'zila')">
                                    <option value="">Select Zila</option>

                                    <option *ngFor="let zila of shippingZilaSearchOptions" value="{{zila.id}}">
                                        {{zila.name}}
                                    </option>
                                </select>
                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('shipping_zila_id').dirty || showFormError) && getSignUpFormControl('shipping_zila_id').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Zila is required!
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Select Upazila</label>
                                <select class="form-control" formControlName="shipping_upazila_id"
                                        (click)="checkAddressSegment('shipping', 'upazila')">
                                    <option value="">Select Upazila</option>

                                    <option *ngFor="let upazila of shippingUpazilaSearchOptions" value="{{upazila.id}}">
                                        {{upazila.name}}
                                    </option>
                                </select>
                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('shipping_upazila_id').dirty || showFormError) && getSignUpFormControl('shipping_upazila_id').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Upazila is required!
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Address</label>
                                <input type="text" class="form-control" formControlName="shippingAddress"
                                       placeholder="Enter address">
                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('shippingAddress').dirty || showFormError) && getSignUpFormControl('shippingAddress').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Address is required!
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Post Code </label>
                                <input type="number" class="form-control" formControlName="shippingPostCode"
                                       placeholder="Enter post code">
                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('shippingPostCode').dirty || showFormError) && getSignUpFormControl('shippingPostCode').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Post Code is required!
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="checkbox">
                        <input type="checkbox" id="checkbox5" (change)="copyAll()" [(ngModel)]="isCopy"
                               [ngModelOptions]="{standalone: true}" checked>
                        <label for="checkbox5"><span>Copy billing details to shipping</span></label>
                    </div>
                    <div class="Checkout-from1" *ngIf='isDelivery' [hidden]="isCopy">
                        <p>Billing address</p>

                        <div class="form-row" *ngIf="!newBillingAddress">
                            <div class="Checkout-from1">
                                <label>Select address</label>
                                <mat-radio-group formControlName="billing_id"
                                                 (change)="onAddressChange($event.value, 'billing')">
                                    <div class="border-bottom radio2"
                                         *ngFor="let address of prevoius_address; let i = index">
                                        <mat-radio-button value="{{address.id}}">
                                            &nbsp;{{ address?.address }},{{ address?.division_id.name }},{{
                                            address?.upazila_id.name
                                            }},{{ address?.zila_id.name }}.
                                        </mat-radio-button>
                                    </div>
                                </mat-radio-group>
                            </div>
                        </div>

                        <div class="row send-btn1 mb-2">
                            <button (click)="onAddressToggle($event, 'billing')">
                                <a *ngIf="!newBillingAddress">New Billing address</a>
                                <a *ngIf="newBillingAddress">Select from previous</a>
                            </button>
                        </div>

                        <div class="form-row" *ngIf="newBillingAddress">
                            <div class="form-group col-md-6">
                                <label>First Name</label>
                                <input type="text" class="form-control" formControlName="firstName"
                                       placeholder="Input First Name">
                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('firstName').dirty || showFormError) && getSignUpFormControl('firstName').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>First name is required!
                                    </span>
                                    <span *ngIf="(getSignUpFormControl('firstName').dirty) && getSignUpFormControl('firstName').hasError('onlyName')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Only character is allowed!
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Last Name</label>
                                <input type="text" class="form-control" formControlName="lastName"
                                       placeholder="Input Last Name">
                                <!--<div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('lastName').dirty || showFormError) && getSignUpFormControl('lastName').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Last name is required!
                                    </span>
                                    <span *ngIf="(getSignUpFormControl('lastName').dirty) && getSignUpFormControl('lastName').hasError('onlyName')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Only character is allowed!
                                    </span>
                                </div>-->
                            </div>
                            <div class="form-group col-md-6">
                                <label>Phone Number</label>
                                <input type="text" class="form-control" formControlName="phone"
                                       placeholder="Enter your phone number">

                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('phone').dirty  || showFormError) && getSignUpFormControl('phone').hasError('required')">
                                        <i class='fa fa-exclamation-circle mr-2'></i>Phone Number is required!</span>
                                    <span *ngIf="getSignUpFormControl('phone').dirty && getSignUpFormControl('phone').hasError('phoneNumber')"><i
                                            class='fa fa-exclamation-circle mr-2'></i>Enter a right Phone Number!</span>
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Select Division</label>
                                <select class="form-control" formControlName="division_id"
                                        (change)="divisionChange($event, 'billing')">
                                    <option value="">Select Division</option>

                                    <option *ngFor="let division of divisionSearchOptions" value="{{division.id}}">
                                        {{division.name}}
                                    </option>
                                </select>
                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('division_id').dirty || showFormError) && getSignUpFormControl('division_id').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Division is required!
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Select Zila</label>
                                <select class="form-control" formControlName="zila_id"
                                        (change)="zilaChange($event, 'billing')"
                                        (click)="checkAddressSegment('billing', 'zila')">
                                    <option value="">Select Zila</option>
                                    <option *ngFor="let zila of zilaSearchOptions" value="{{zila.id}}">
                                        {{zila.name}}
                                    </option>
                                </select>
                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('zila_id').dirty || showFormError) && getSignUpFormControl('zila_id').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Zila is required!
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Select Upazila</label>
                                <select class="form-control" formControlName="upazila_id"
                                        (click)="checkAddressSegment('billing', 'upazila')">
                                    <option value="">Select Upazila</option>

                                    <option *ngFor="let upazila of upazilaSearchOptions" value="{{upazila.id}}">
                                        {{upazila.name}}
                                    </option>
                                </select>
                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('upazila_id').dirty || showFormError) && getSignUpFormControl('upazila_id').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Upazila is required!
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Address </label>
                                <input type="text" class="form-control" formControlName="address"
                                       placeholder="Enter address">
                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('address').dirty || showFormError) && getSignUpFormControl('address').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Address is required!
                                    </span>
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Post Code </label>
                                <input type="number" class="form-control" formControlName="postCode"
                                       placeholder="Enter post code">
                                <div class="validation-feedback">
                                    <span *ngIf="(getSignUpFormControl('postCode').dirty || showFormError) && getSignUpFormControl('postCode').hasError('required')">
                                      <i class='fa fa-exclamation-circle mr-2'></i>Post Code is required!
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="pick-up" *ngIf='isPickup'>
                        <p>Who will pick up this order?</p>
                        <form>
                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label for="inputEmail4">Name</label>
                                    <input type="text" class="form-control" id="inputEmail4" placeholder="Input Name">
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="inputEmail4">Name</label>
                                    <input type="text" class="form-control" id="inputEmail41" placeholder="Input Name">
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="collect-from" *ngIf='isPickup'>
                        <p>Where do you want to collect from?</p>
                        <form>
                            <div class="form-row">
                                <div class="form-group col-md-12">
                                    <label for="inputEmail4">Name</label>
                                    <input type="text" class="form-control" id="inputEmail42" placeholder="Input Name">
                                </div>
                            </div>
                        </form>
                        <button class="collectbtn">Search</button>
                    </div>
                    <div class="nearst-shop" *ngIf='isPickup'>
                        <p>Your nearst shop</p>
                        <div class="nearstshops">
                            <div class="nearst-media1">
                                <li class="media">
                                    <img class="mr-3" src="../../../../assets/images/nearst1.jpg"
                                         alt="Generic placeholder image">
                                    <div class="media-body">
                                        <h6 class="mt-0 mb-1">Trust Mobile BD</h6>
                                        <p>Dhaka, Dhaka North, Banani Road No. 12-19</p>
                                        <span>Open Time: 9:00 AM-10:00 PM</span>
                                    </div>
                                </li>
                            </div>
                            <div class="nearst-2">
                                <span>0.31 miles</span>
                                <button><a href="#">Select shop</a></button>
                            </div>
                        </div>
                        <div class="nearstshops border-bottom-0">
                            <div class="nearst-media1">
                                <li class="media">
                                    <img class="mr-3" src="../../../../assets/images/nearst2.jpg"
                                         alt="Generic placeholder image">
                                    <div class="media-body">
                                        <h6 class="mt-0">Best Electronics</h6>
                                        <p>Dhaka, Dhaka North, Banani Road No. 12-19</p>
                                        <span>Open Time: 9:00 AM-10:00 PM</span>
                                    </div>
                                </li>
                            </div>
                            <div class="nearst-2">
                                <span>0.31 miles</span>
                                <button><a href="#">Select shop</a></button>
                            </div>
                        </div>
                    </div>
                </div>

                <div [ngClass]="{'col-lg-12': noShippingCharge, 'col-lg-6': !noShippingCharge, 'col-md-12': true}"
                     style="max-width: none;">
                    <div class="bag-item">
                        <p>Your Cart {{cartData?.data.total_quantity}} items</p>
                    </div>
                    <div *ngIf="cartData?.data.total_quantity > 0; else message">
                        <div class="row">
                            <div class="bag-item col-12" *ngFor="let cartItem of cartData?.data.cart_items">
                                <div class="bagitem-1">
                                    <div class="productimage-wrapper">
                                        <img class="product-image"
                                             src="{{LIST_IMAGE_ENDPOINT + cartItem.product_id.image + IMAGE_EXT}}"
                                             alt="product image">
                                    </div>
                                    <div style="width:95%" class="text">
                                        <div class="sub-text" style="width:70%">
                                            <a routerLink="/product-details/{{cartItem.product_id.id}}">
                                                <p>{{cartItem.product_id.name}}</p>
                                            </a>
                                            <ng-container
                                                    *ngIf="cartItem.cartitemvariant && cartItem.cartitemvariant.length>0">
                                                <span *ngFor="let variant of cartItem.cartitemvariant">
                                                  {{variant.variant_id.name}}
                                                    :<small>{{variant.warehouse_variant_id.name}}</small>
                                                </span>
                                            </ng-container>
                                        </div>
                                        <ul style="width:15%">
                                            <li class="cursor-pointer"
                                                (click)="changeCartItemQuantity(cartItem, 'decrease')">
                                                -
                                            </li>
                                            <li>{{cartItem.product_quantity}}</li>
                                            <li class="mr-0 cursor-pointer"
                                                (click)="changeCartItemQuantity(cartItem, 'increase')">+
                                            </li>
                                        </ul>
                                        <p style="width:15%">৳. {{cartItem.product_total_price}}
                                            <button style="width: 0" (click)="removeCartItem(cartItem.id)"
                                                    type="button" class="close" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="tag3">
                                    <h5 [ngStyle]="{'text-align': noShippingCharge ? 'center': 'left'}">Order
                                        Summary</h5>
                                    <table [ngStyle]="{'width': noShippingCharge ? '100%': '100%', 'margin': noShippingCharge ? 'auto': '0', 'max-width': noShippingCharge ? '500px': '600px'}">
                                        <tr>
                                            <td class="td1 pr-5">Subtotal</td>
                                            <td class="ml-5">৳ {{cartData?.data.total_price}}</td>
                                        </tr>
                                        <tr>
                                            <td class="td1 pr-5">Discount</td>
                                            <td class="active ml-5">৳ 0.00</td>
                                        </tr>
                                        <tr *ngIf="!noShippingCharge">
                                            <td class="td1 pr-5">Shipping</td>
                                            <td class="ml-5">৳ {{shippingCharge}}</td>
                                        </tr>
                                        <tr class="border-bottom-0">
                                            <td class="td1 pr-5">Total</td>
                                            <td class="ml-5">৳ {{grantTotal}}</td>
                                        </tr>
                                    </table>
                                    <p class="alert alert-info text-info" *ngIf="!noShippingCharge">
                                        Delivery Charge: <br>
                                        Inside Dhaka Metro- 60/- (+Delivery charge will increase if product is
                                        heavier)<br>
                                        Outside Dhaka Metro- 150/- (+Delivery charge will increase if product is
                                        heavier)
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div [ngClass]="{'send-btn1': true, 'text-center': noShippingCharge}">
                            <button (click)="processToPay(illegalCartItemsWarningModal)" class="Summarybtn"
                                    style="margin-top: 10px">
                                <a>Process to Pay</a>
                            </button>
                        </div>
                    </div>
                    <ng-template #message>
                        <div><p>No item in your cart.</p></div>
                    </ng-template>
                </div>
            </div>
        </div>
    </div>

    <div id="payment-method" class="payment-method" *ngIf="showPayment && !successOrderId">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-6 col-sm-6 col-12 mb-4">
                    <div class="payment-method-details1 mt-5">
                        <p class="font-weight-bold">Payment Method</p>
                        <mat-radio-group formControlName="paymentType">
                            <div class="radio2" *ngIf="!isAllowedOfferPaymentGateway">
                                <mat-radio-button
                                        *ngIf="enabledPaymentMethods[CASHBACK_PAYMENT_TYPE] && couponCashbackAmount > 0 && grantTotal <= couponCashbackAmount"
                                        value="CashBack" (click)="showOfflineForm(false)">
                                    <i class="fa fa-money"></i>By Using Cashback
                                </mat-radio-button>
                                <mat-radio-button
                                        *ngIf="!disableCashOnDelivery && !hideCashonDelivery && enabledPaymentMethods[CASH_PAYMENT_TYPE]"
                                        value="Cash" (click)="showOfflineForm(false)">
                                    <i class="fa fa-money"></i>Cash On Delivery
                                </mat-radio-button>
                                <mat-radio-button *ngIf="enabledPaymentMethods[OFFLINE_PAYMENT_TYPE] && isOfflinePayable"
                                                  value="OfflinePay" (click)="showOfflineForm(true)">
                                    <div class="payment-icon-container">
                                        <img src="../../../../assets/images/payByBank.png"
                                             style="height: auto; width: 80%;"
                                             alt="SSLcommerce"/>
                                    </div>
                                </mat-radio-button>

                                <!-- Show Offline payment form. START -->
                                <div *ngIf="isShowOfflineForm" class="mb-5">
                                    <mat-radio-group class="payment-method-radio-btn" formControlName="offlinePaymentMethods" style="display: flex">
                                        <mat-radio-button value="cashInAdvance"
                                                          (click)="showOfflinePaymentMethods(true, false, false, false)">
                                            <p class="defaultParagraph">Cash In Advance</p>
                                        </mat-radio-button>
                                        <mat-radio-button value="bankTransfer"
                                                          (click)="showOfflinePaymentMethods(false, true, false, false)">
                                            <p class="defaultParagraph">Bank transfer</p>
                                        </mat-radio-button>
                                        <mat-radio-button value="bankDeposit"
                                                          (click)="showOfflinePaymentMethods(false, false, true, false)">
                                            <p class="defaultParagraph">Bank deposit</p>
                                        </mat-radio-button>
                                        <mat-radio-button value="mobileTransfer"
                                                          (click)="showOfflinePaymentMethods(false, false, false, true)">
                                            <p class="defaultParagraph">Direct Mobile Transfer</p>
                                        </mat-radio-button>
                                    </mat-radio-group>
                                    <div class="validation-feedback">
                                    <span *ngIf="!(getSignUpFormControl('offlinePaymentMethods').dirty)">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>You have to select a offline payment method must!
                                    </span>
                                    </div>
                                    <div *ngIf="isShowCashInAdvanceForm">
                                        <image-upload [max]="1" (removed)="onRemoved($event)"
                                                      [beforeUpload]="onBeforeUpload" buttonCaption="Select image"
                                                      dropBoxMessage="Drop picture of cash memo provided by Anonder Bazar authority!"
                                                      clearButtonCaption="clear">
                                        </image-upload>
                                        <div class="validation-feedback">
                                    <span *ngIf="!ImageFile">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Upload cash memo image first!
                                    </span>
                                        </div>
                                    </div>
                                    <div *ngIf="isShowBankTransferForm">
                                        <label>Transaction number</label>
                                        <input type="text" class="form-control" formControlName="transactionIdForBank"
                                               placeholder="Enter bank transaction number">
                                        <div class="validation-feedback">
                                    <span *ngIf="!getSignUpFormControl('transactionIdForBank').value">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Bank transaction number is required!
                                    </span>
                                        </div>
                                        <label>Bank name</label>
                                        <input type="text" class="form-control" formControlName="bankName"
                                               placeholder="Enter Bank Name">
                                        <div class="validation-feedback">
                                    <span *ngIf="!getSignUpFormControl('bankName').value">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Bank name is required!
                                    </span>
                                        </div>
                                        <label>Branch name</label>
                                        <input type="text" class="form-control" formControlName="branchName"
                                               placeholder="Enter Branch name">
                                        <div class="validation-feedback">
                                    <span *ngIf="!getSignUpFormControl('branchName').value">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Bank branch name is required!
                                    </span>
                                        </div>
                                        <label>Account Number</label>
                                        <input type="number" class="form-control" formControlName="accountNumberForBank"
                                               placeholder="Enter Account Number">
                                        <div class="validation-feedback">
                                    <span *ngIf="!getSignUpFormControl('accountNumberForBank').value">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Account number is required!
                                    </span>
                                        </div>
                                    </div>
                                    <div *ngIf="isBankDeposit">
                                        <image-upload [max]="1" (removed)="onRemovedBankDepositSlip($event)"
                                                      [beforeUpload]="onBeforeUploadBankaDepositSlip" buttonCaption="Select image"
                                                      dropBoxMessage="Drop picture of bank deposit slip"
                                                      clearButtonCaption="clear">
                                        </image-upload>
                                        <div class="validation-feedback">
                                    <span *ngIf="!BankDepositImageFile">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Upload bank deposit slip image first!
                                    </span>
                                        </div>
                                    </div>

                                    <div *ngIf="isMobileTransfer">
                                        <image-upload [max]="1" (removed)="onRemovedMobileTransferSS($event)"
                                                      [beforeUpload]="onBeforeUploadMobileTransferSS" buttonCaption="Select image"
                                                      dropBoxMessage="Drop screenshot of payment page"
                                                      clearButtonCaption="clear">
                                        </image-upload>
                                        <div class="validation-feedback">
                                    <span *ngIf="!mobileTransferImageFile">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Upload screenshot of payment first!
                                    </span>
                                        </div>
                                    </div>
                                </div>
                                <!-- Show Offline payment form. END -->

                                <mat-radio-button *ngIf="enabledPaymentMethods[SSL_COMMERZ_PAYMENT_TYPE]"
                                                  value="SSLCommerce"
                                                  [checked]="hideCashonDelivery"  (click)="showOfflineForm(false)">
                                    <div class="payment-icon-container">
                                        <img src="../../../../assets/images/final_sslcommerz.webp"
                                             style="height: auto; width: 80%;"
                                             alt="SSLcommerce"/>
                                    </div>
                                </mat-radio-button>
                                <mat-radio-button *ngIf="enabledPaymentMethods[BKASH_PAYMENT_TYPE] && showBkashPayment"
                                                  value="bKash" (click)="showOfflineForm(false)">
                                    <div class="payment-icon-container">
                                        <img src="../../../../assets/images/bkash.gif" style="height: auto; width: 70%;"
                                             alt="bKash"/>
                                    </div>
                                </mat-radio-button>
                                <mat-radio-button *ngIf="enabledPaymentMethods[NAGAD_PAYMENT_TYPE]" value="nagad">
                                    <div class="payment-icon-container">
                                        <img src="../../../../assets/images/nagad.png" style="height: auto; width: 70%;"
                                             alt="nagad"/>
                                    </div>
                                </mat-radio-button>
                            </div>

                            <div class="radio2" *ngIf="isAllowedOfferPaymentGateway">
                                <mat-radio-button
                                        *ngIf="!hideCashonDelivery && enabledPaymentMethods[CASH_PAYMENT_TYPE]
                                        && isAllowedCashInDeliveryInOfferedProductPurchase"
                                        value="Cash" (click)="showOfflineForm(false)">
                                    <i class="fa fa-money"></i>Cash On Delivery
                                </mat-radio-button>
                                <mat-radio-button *ngIf="enabledPaymentMethods[OFFLINE_PAYMENT_TYPE]
                                                        && isAllowedOfflineInOfferedProductPurchase"
                                                  value="OfflinePay" (click)="showOfflineForm(true)">
                                    <div class="payment-icon-container">
                                        <img src="../../../../assets/images/payByBank.png"
                                             style="height: auto; width: 80%;"
                                             alt="SSLcommerce"/>
                                    </div>
                                </mat-radio-button>

                                <!-- Show Offline payment form. START -->
                                <div *ngIf="isShowOfflineForm" class="mb-5">
                                    <mat-radio-group class="payment-method-radio-btn" formControlName="offlinePaymentMethods" style="display: flex">
                                        <mat-radio-button value="cashInAdvance"
                                                          (click)="showOfflinePaymentMethods(true, false, false, false)">
                                            <p class="defaultParagraph">Cash In Advance</p>
                                        </mat-radio-button>
                                        <mat-radio-button value="bankTransfer"
                                                          (click)="showOfflinePaymentMethods(false, true, false, false)">
                                            <p class="defaultParagraph">Bank transfer</p>
                                        </mat-radio-button>
                                        <mat-radio-button value="bankDeposit"
                                                          (click)="showOfflinePaymentMethods(false, false, true, false)">
                                            <p class="defaultParagraph">Bank deposit</p>
                                        </mat-radio-button>
                                        <mat-radio-button value="mobileTransfer"
                                                          (click)="showOfflinePaymentMethods(false, false, false, true)">
                                            <p class="defaultParagraph">Direct Mobile Transfer</p>
                                        </mat-radio-button>
                                    </mat-radio-group>
                                    <div class="validation-feedback">
                                    <span *ngIf="!(getSignUpFormControl('offlinePaymentMethods').dirty)">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>You have to select a offline payment method must!
                                    </span>
                                    </div>
                                    <div *ngIf="isShowCashInAdvanceForm">
                                        <image-upload [max]="1" (removed)="onRemoved($event)"
                                                      [beforeUpload]="onBeforeUpload" buttonCaption="Select image"
                                                      dropBoxMessage="Drop picture of cash memo provided by Anonder Bazar authority!"
                                                      clearButtonCaption="clear">
                                        </image-upload>
                                        <div class="validation-feedback">
                                    <span *ngIf="!ImageFile">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Upload cash memo image first!
                                    </span>
                                        </div>
                                    </div>
                                    <div *ngIf="isShowBankTransferForm">
                                        <label>Transaction number</label>
                                        <input type="text" class="form-control" formControlName="transactionIdForBank"
                                               placeholder="Enter bank transaction number">
                                        <div class="validation-feedback">
                                    <span *ngIf="!getSignUpFormControl('transactionIdForBank').value">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Bank transaction number is required!
                                    </span>
                                        </div>
                                        <label>Bank name</label>
                                        <input type="text" class="form-control" formControlName="bankName"
                                               placeholder="Enter Bank Name">
                                        <div class="validation-feedback">
                                    <span *ngIf="!getSignUpFormControl('bankName').value">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Bank name is required!
                                    </span>
                                        </div>
                                        <label>Branch name</label>
                                        <input type="text" class="form-control" formControlName="branchName"
                                               placeholder="Enter Branch name">
                                        <div class="validation-feedback">
                                    <span *ngIf="!getSignUpFormControl('branchName').value">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Bank branch name is required!
                                    </span>
                                        </div>
                                        <label>Account Number</label>
                                        <input type="number" class="form-control" formControlName="accountNumberForBank"
                                               placeholder="Enter Account Number">
                                        <div class="validation-feedback">
                                    <span *ngIf="!getSignUpFormControl('accountNumberForBank').value">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Account number is required!
                                    </span>
                                        </div>
                                    </div>
                                    <div *ngIf="isBankDeposit">
                                        <image-upload [max]="1" (removed)="onRemovedBankDepositSlip($event)"
                                                      [beforeUpload]="onBeforeUploadBankaDepositSlip" buttonCaption="Select image"
                                                      dropBoxMessage="Drop picture of bank deposit slip"
                                                      clearButtonCaption="clear">
                                        </image-upload>
                                        <div class="validation-feedback">
                                    <span *ngIf="!BankDepositImageFile">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Upload bank deposit slip image first!
                                    </span>
                                        </div>
                                    </div>

                                    <div *ngIf="isMobileTransfer">
                                        <image-upload [max]="1" (removed)="onRemovedMobileTransferSS($event)"
                                                      [beforeUpload]="onBeforeUploadMobileTransferSS" buttonCaption="Select image"
                                                      dropBoxMessage="Drop screenshot of payment page"
                                                      clearButtonCaption="clear">
                                        </image-upload>
                                        <div class="validation-feedback">
                                    <span *ngIf="!mobileTransferImageFile">
                                      <i class='fa fa-exclamation-circle mr-2 warning-icon'></i>Upload screenshot of payment first!
                                    </span>
                                        </div>
                                    </div>
                                </div>
                                <!-- Show Offline payment form. END -->

                                <mat-radio-button *ngIf="enabledPaymentMethods[SSL_COMMERZ_PAYMENT_TYPE]
                                                        && isAllowedSslCommerzInOfferedProductPurchase"
                                                  value="SSLCommerce"
                                                  [checked]="hideCashonDelivery"  (click)="showOfflineForm(false)">
                                    <div class="payment-icon-container">
                                        <img src="../../../../assets/images/final_sslcommerz.webp"
                                             style="height: auto; width: 80%;"
                                             alt="SSLcommerce"/>
                                    </div>
                                </mat-radio-button>
                                <mat-radio-button *ngIf="enabledPaymentMethods[BKASH_PAYMENT_TYPE] && showBkashPayment
                                                          && isAllowedBkashInOfferedProductPurchase"
                                                  value="bKash" (click)="showOfflineForm(false)">
                                    <div class="payment-icon-container">
                                        <img src="../../../../assets/images/bkash.gif" style="height: auto; width: 70%;"
                                             alt="bKash"/>
                                    </div>
                                </mat-radio-button>
                                <mat-radio-button *ngIf="enabledPaymentMethods[NAGAD_PAYMENT_TYPE]" value="nagad">
                                    <div class="payment-icon-container">
                                        <img src="../../../../assets/images/nagad.png" style="height: auto; width: 70%;"
                                             alt="nagad"/>
                                    </div>
                                </mat-radio-button>
                            </div>
                        </mat-radio-group>
                    </div>


                    <!--terms and conditions checkbox-->
                    <div style="margin-top: 20px;">
                        <input style="min-height: 0" type="checkbox" id="termsAndPolicy" [checked]="termsAndPolicy"
                               (change)="termsAndPolicy = !termsAndPolicy"/>
                        <label for="termsAndPolicy" style="margin: 40px 0 0 10px; display: initial">I agree to the <a
                                routerLink="/cms/post-details/112" target="_blank" style="color: #F83831">Terms &
                            Conditions</a>, <a routerLink="/cms/post-details/40" target="_blank" style="color: #F83831">Privacy
                            Policy</a> and
                            <a routerLink="/cms/post-details/117" target="_blank" style="color: #F83831">Refund and Return
                                Policy</a> of Anonder Bazar</label>
                    </div>

                    <div class="send-btn1" (click)="disabledButtonClick(termsAndPolicy)">
                        <button type="submit" class="Summarybtn" [disabled]="!termsAndPolicy" *ngIf="isShowOfflineForm"
                                (click)="saveOrderForOfflinePayment($event, checkoutForm.value)">
                            <a>Confirm Order</a>
                        </button>
                        <button type="submit" class="Summarybtn" [disabled]="!termsAndPolicy" *ngIf="!isShowOfflineForm"
                                (click)="formCheckout($event, checkoutForm.value, bKashWalletModalTemplate)">
                            <a>Confirm payment</a>
                        </button>
                        <button type="submit" class="Summarybtn" id="sum-btn-w-o-payment" *ngIf="isPartiallyPayable && !isShowOfflineForm"
                                (click)="formConfirmWithoutPayment($event, checkoutForm.value)"
                                [disabled]="!termsAndPolicy">
                            <a>Confirm without payment</a>
                        </button>
                    </div>
                </div>
                <div class="col-md-6 col-sm-6 col-12 mb-4">
                    <div class="payment-method-details2">
                        <ng-container *ngIf="!noShippingCharge">
                            <div class="tag1">
                                <p>Shipping address<a (click)="showPayment=false" style="color: red">Edit</a></p>
                                <small>Address</small>
                                <p class="add">{{getAddress('shipping')}}</p>
                            </div>
                            <div class="tag2">
                                <p>Billing address<a (click)="showPayment=false" style="color: red">Edit</a></p>
                                <small>Address</small>
                                <p class="add">{{getAddress('billing')}}</p>
                            </div>
                        </ng-container>
                        <div class="tag3">
                            <p>Order Summary</p>
                            <table>
                                <tr>
                                    <td class="td1">Subtotal</td>
                                    <td>৳ {{cartData?.data.total_price}}</td>
                                </tr>
                                <tr>
                                    <td class="td1 pr-5">Discount</td>
                                    <td class="active">৳ 0.00</td>
                                </tr>
                                <tr *ngIf="!noShippingCharge">
                                    <td class="td1 pr-5">Shipping</td>
                                    <td class="ml-5">৳ {{shippingCharge}}</td>
                                </tr>
                                <tr class="border-bottom-0">
                                    <td class="td1 pr-5">Total</td>
                                    <td>৳ {{grantTotal}}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
<section id="success-section" *ngIf="successOrderId">
    <div class="col-md-6 offset-md-3">
        <div class="success-details text-center">
            <img src="../../../../assets/images/tick.png" alt="">
            <h6>Thanks, your order has been placed</h6>
            <p>Your order number is {{successOrderId}} <br>
                We;ve send you an email confirmation</p>
            <button [routerLink]="['/profile/orders/invoice/', successOrderId]">
                <a>View Invoice</a>
            </button>
            <button class="Summarybtn" routerLink="/"><a>Back to Home</a></button>
        </div>
    </div>
</section>

<ng-template #illegalCartItemsWarningModal>
    <div class="form-card">
        <img src="/assets/images/warning.png" style="display: block; height: 50px; margin: auto;">
        <p style="text-align: center; margin-top: 10px; font-size: 20px;">You can't purchase different offer products 'or' an offer product with a regular product in a single cart.</p>
    </div>
</ng-template>

<ng-template #bKashWalletModalTemplate>
    <div class="modal-header">
        <h4 class="modal-title pull-left">My bKash Wallets</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="bKashWalletModalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body" style="color: #444444;">
        <ul class="list-group" *ngIf="authUserWallets && authUserWallets.length > 0; else noWalletTemplate">
            <li class="list-group-item" *ngFor="let authUserWallet of authUserWallets; let i = index">
                <span>{{authUserWallet.wallet_no}}</span>
                <a class="btn btn-primary btn-sm" style="margin-left: 50px;"
                   (click)="proceedWithBkash($event, checkoutForm.value, authUserWallet)">Proceed with bKash</a>
            </li>
        </ul>
        <ng-template #noWalletTemplate>
            <p class="alert alert-info">
                You don't have any bKash Wallet added. Please first add a bKash Wallet from <a
                    (click)="noBKashWalletAction($event)"> Here </a> and then proceed with checkout.
            </p>
        </ng-template>
    </div>
    <div class="modal-footer">
        <div class="btn-group pull-right" role="group" aria-label="First group">
            <button type="button" class="btn btn-default" (click)="bKashWalletModalRef.hide()">Cancel</button>
        </div>
    </div>
</ng-template>

