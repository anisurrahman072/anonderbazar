<div *ngIf="isModalShown$|async" [config]="{ show: true,animated:false }" (onHidden)="onHidden()" bsModal
     #autoShownModal="bs-modal"
     class="modal login-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">

            <!--close button at the top right of the modal-->
            <div class="modal-header">
                <button type="button" class="close pull-right" aria-label="Close" (click)="hideModal()">
                    <i class="fa  fa-close"></i>
                </button>
            </div>

            <div class="modal-body">

                <!--body section starts-->
                <div class=" container form-background" style="height: auto;">
                    <!--Login Form-->
                    <ng-container *ngIf="!register && !isForgot && !showVerifyModal">
                        <section id="signup-section-login" style="padding: 0;">
                            <div class="col-md-12">
                                <div class="mb-3 mx-lg-auto w-25">
                                    <img src="assets/images/logo.png" alt="Logo">
                                </div>
                                <h4 class="signup-title">Sign In</h4>
                                <div *ngIf="loginErrorMessage" class="alert alert-danger text-center text-capitalize"
                                     role="alert">
                                    {{loginErrorMessage}}
                                </div>

                                <div class="signup-form">
                                    <form class="form-horizontal m-t-50" [formGroup]="validateForm"
                                          (ngSubmit)="submitForm($event,validateForm.value)">
                                        <div class="row">
                                            <div class="form-group w-100"
                                                 [ngClass]="{'has-error': getFormControl('username').dirty && getFormControl('username').hasError('required'), 'has-success':getFormControl('username').dirty&&!getFormControl('username').hasError('required') }">
                                                <label for="username" class="col-lg-12 control-label">Phone
                                                    Number <span class="required">*</span></label>
                                                <div class="col-lg-12">
                                                    <input placeholder="Phone Number" class="form-control" id="username"
                                                           formControlName="username" [autofocus]="true" required>
                                                    <i class='fa fa-check-circle-o feedback-icon-success'></i>
                                                    <i class='fa fa-exclamation-circle feedback-icon-error'></i>
                                                    <div class="validation-feedback">
                                                    <span>
                                                        <i class='fa fa-exclamation-circle'></i> Phone Number is required
                                                    </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="form-group w-100"
                                                 [ngClass]="{'has-error': getFormControl('password').dirty && getFormControl('password').hasError('required'), 'has-success':getFormControl('password').dirty&&!getFormControl('password').hasError('required') }">
                                                <label for="password_login"
                                                       class="col-lg-12 control-label">Password <span
                                                        class="required">*</span></label>
                                                <div class="col-lg-12">
                                                    <input placeholder="Password" class="form-control"
                                                           id="password_login"
                                                           formControlName="password" type="password" required>
                                                    <i class='fa fa-check-circle-o feedback-icon-success'></i>
                                                    <i class='fa fa-exclamation-circle feedback-icon-error'></i>
                                                    <div class="validation-feedback">
                                                <span>
                                                    <i class='fa fa-exclamation-circle'></i> Password is required
                                                </span>

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mb-2">
                                                <div class="col-md-12">
                                                    <a type="button" (click)="showForgot()" style="color: #FF0000;">Forgot
                                                        your password?</a>
                                                </div>
                                            </div>
                                            <div class="form-group signupbtn col-md-12">
                                                <input id="form_botcheck-login" name="form_botcheck"
                                                       class="form-control" type="hidden" value="">
                                                <button type="submit" class="btn btn-flat"
                                                        *ngIf="!loginSubmitting; else loadingContentLogin"
                                                        data-loading-text="Please wait">Sign In
                                                </button>
                                                <ng-template #loadingContentLogin>
                                                    <button disabled type="button"
                                                            style="color: #333333; font-weight: bold;"
                                                            class="btn btn-flat">
                                                        lease wait
                                                    </button>
                                                </ng-template>
                                            </div>
                                            <div class="d-flex col-md-12 justify-content-around">
                                                <p>
                                                    Create an account?
                                                    <a class="btn-link" style="color: red" (click)="showSignUp()">
                                                        Sign Up
                                                    </a>
                                                </p>
                                                <p>
                                                    Verify OTP?
                                                    <a title="Verify"
                                                       (click)="register =false; showVerifyModal = true;"
                                                       style="color: red">
                                                        Verify
                                                    </a>
                                                </p>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </section>
                    </ng-container>

                    <!--Sign up form-->
                    <ng-container *ngIf="register && !isForgot && !showVerifyModal">
                        <section id="signup-section-register" style="padding: 0;">
                            <div class="col-md-12 offset-md-12">
                                <div class="mb-3 mx-lg-auto w-25">
                                    <img class="text-center" src="assets/images/logo.png" alt="Logo">
                                </div>
                                <h4 class="signup-title text-center">Sign Up</h4>
                                <div class="signup-form">
                                    <form class="form-horizontal m-t-50" [formGroup]="validateSignUpForm"
                                          (ngSubmit)="submitSignupForm($event,validateSignUpForm.value)">

                                        <!--first name and last name row-->
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group"
                                                     [ngClass]="{'has-error': validateSignUpForm.get('first_name').dirty && validateSignUpForm.get('first_name').errors, 'has-success': validateSignUpForm.get('first_name').dirty&&!validateSignUpForm.get('first_name').errors }">
                                                    <label for="first_name" class="col-lg-12 control-label">First
                                                        Name <span class="required">*</span></label>
                                                    <div class="col-lg-12">
                                                        <input placeholder="Input your first name" class="form-control"
                                                               id="first_name"
                                                               formControlName="first_name" [autofocus]="true" required>
                                                        <i class='fa fa-check-circle-o feedback-icon-success'></i>
                                                        <i class='fa fa-exclamation-circle feedback-icon-error'></i>
                                                        <div class="validation-feedback">
                                                            <span><i class='fa fa-exclamation-circle'></i> First name is required! </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group"
                                                     [ngClass]="{'has-success': validateSignUpForm.get('last_name').dirty }">
                                                    <label for="last_name" class="col-lg-12 control-label">Last
                                                        Name</label>
                                                    <div class="col-lg-12">
                                                        <input placeholder="Input your last name" class="form-control"
                                                               id="last_name"
                                                               formControlName="last_name" [autofocus]="true">
                                                        <i class='fa fa-check-circle-o feedback-icon-success'></i>
                                                        <i class='fa fa-exclamation-circle feedback-icon-error'></i>
                                                        <div class="validation-feedback" style="display: none;">
                                                        <span>
                                                            <i class='fa fa-exclamation-circle'></i> Last name is required! </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--first name and last name row ends-->

                                        <!--phone and email starts-->
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group"
                                                     [ngClass]="{'has-error': validateSignUpForm.get('phone').dirty && validateSignUpForm.get('phone').errors, 'has-success': validateSignUpForm.get('phone').dirty && !validateSignUpForm.get('phone').errors }">
                                                    <label for="phone" class="col-lg-12 control-label">Phone
                                                        Number <span class="required">*</span></label>
                                                    <div class="col-lg-12">
                                                        <input placeholder="Enter your phone number" id="phone"
                                                               class="form-control" formControlName="phone"
                                                               [autofocus]="true" required ngModel
                                                               (ngModelChange)="updatePhoneValidator()">
                                                        <i class='fa fa-check-circle-o feedback-icon-success'></i>
                                                        <i class='fa fa-exclamation-circle feedback-icon-error'></i>
                                                        <div class="validation-feedback">
                                                            <span *ngIf="getSignUpFormControl('phone').dirty && getSignUpFormControl('phone').hasError('required')">
                                                                <i class='fa fa-exclamation-circle mr-2'></i>Phone number is required!</span>
                                                            <span *ngIf="getSignUpFormControl('phone').dirty && !getSignUpFormControl('phone').hasError('required') && getSignUpFormControl('phone').hasError('phoneNumber')">
                                                                <i class='fa fa-exclamation-circle mr-2'></i>Enter a right phone number!</span>
                                                            <span *ngIf="getSignUpFormControl('phone').dirty && !getSignUpFormControl('phone').hasError('required')  && getSignUpFormControl('phone').hasError('phoneNumberUnique')">
                                                                <i class='fa fa-exclamation-circle mr-2'></i>This number is already registered!</span>
                                                            <span *ngIf="getSignUpFormControl('phone').dirty && getSignUpFormControl('phone').pending">
                                                                Checking...
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group"
                                                     [ngClass]="{'has-error': validateSignUpForm.get('email').dirty && validateSignUpForm.get('email').errors, 'has-success': validateSignUpForm.get('email').dirty && !validateSignUpForm.get('email').errors }">
                                                    <label for="emailId" class="col-lg-12 control-label">Email</label>
                                                    <div class="col-lg-12">
                                                        <input placeholder="Enter your Email address (optional)" id="emailId"
                                                               class="form-control" formControlName="email"
                                                               [autofocus]="true">
                                                        <div class="validation-feedback">
                                                            <span *ngIf="getSignUpFormControl('email').hasError('email')">
                                                                <i class='fa fa-exclamation-circle mr-2'></i>Enter a right email address!</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--phone  and email ends-->

                                        <!--password and confirm password starts-->
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group"
                                                     [ngClass]="{'has-error': validateSignUpForm.get('password').dirty && validateSignUpForm.get('password').errors, 'has-success':validateSignUpForm.get('password').dirty && !validateSignUpForm.get('password').errors}">
                                                    <label for="password"
                                                           class="col-lg-12 control-label">Password <span
                                                            class="required">*</span></label>
                                                    <div class="col-lg-12">
                                                        <input placeholder="Input your password" class="form-control"
                                                               id="password"
                                                               formControlName="password" type="password" required
                                                               ngModel
                                                               (ngModelChange)="updateConfirmValidator()">
                                                        <i class='fa fa-check-circle-o feedback-icon-success'></i>
                                                        <i class='fa fa-exclamation-circle feedback-icon-error'></i>
                                                        <div class="validation-feedback">
                                                            <span>
                                                                <i class='fa fa-exclamation-circle'></i> Password  is required!</span>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group"
                                                     [ngClass]="{'has-error': validateSignUpForm.get('confirmPassword').dirty && validateSignUpForm.get('confirmPassword').errors,'has-success':validateSignUpForm.get('confirmPassword').dirty && !validateSignUpForm.get('confirmPassword').errors}">
                                                    <label for="confirmPassword" class="col-lg-12 control-label">Confirm
                                                        Password <span class="required">*</span></label>
                                                    <div class="col-lg-12">
                                                        <input placeholder="Input your password again"
                                                               id="confirmPassword"
                                                               class="form-control" formControlName="confirmPassword"
                                                               type="password" required>
                                                        <i class='fa fa-check-circle-o feedback-icon-success'></i>
                                                        <i class='fa fa-exclamation-circle feedback-icon-error'></i>
                                                        <div class="validation-feedback">
                                                            <span>
                                                                <i class='fa fa-exclamation-circle'></i> {{validateSignUpForm.get('confirmPassword').hasError('confirm') ? 'Incorrect Password' : 'Input password again'}}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--password and confirm password ends-->

                                        <!--Gender and date of birth starts-->
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group"
                                                     [ngClass]="{'has-success': validateSignUpForm.get('gender').dirty }">
                                                    <label for="gender" class="col-lg-12 control-label">Gender</label>
                                                    <div class="col-lg-12">
                                                        <div class="gender">
                                                            <select name="gender" class="form-control" id="gender"
                                                                    formControlName="gender">
                                                                <option value="" [selected]="true">Select Gender
                                                                </option>
                                                                <option *ngFor="let option of genderSearchOptions"
                                                                        [ngValue]="option.value">
                                                                    {{option.label}}
                                                                </option>
                                                            </select>
                                                        </div>
                                                        <i class='fa fa-check-circle-o feedback-icon-success'></i>
                                                        <i class='fa fa-exclamation-circle feedback-icon-error'></i>
                                                        <div class="validation-feedback" style="display: none;">
                                                            <span>
                                                                <i class='fa fa-exclamation-circle mr-2'></i>Gender is required!</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class=" col-md-6">
                                                <div class="form-group">
                                                    <label for="full_birth_date" class="col-lg-12 control-label">Birthday</label>
                                                    <div class="col-lg-12">
                                                        <input [matDatepicker]="fullBirthDatePicker"
                                                               [min]="minBirthDate" [max]="maxBirthDate"
                                                               formControlName="full_birth_date" readonly
                                                               id="full_birth_date" placeholder="Choose a date">
                                                        <mat-datepicker-toggle matSuffix
                                                                               [for]="fullBirthDatePicker"></mat-datepicker-toggle>
                                                        <mat-datepicker #fullBirthDatePicker></mat-datepicker>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--Gender and date of birth ends-->

                                        <div class="row">
                                            <div class="form-group signupbtn d-flex col-md-12">
                                                <input id="form_botcheck-register" name="form_botcheck"
                                                       class="form-control"
                                                       type="hidden" value="">
                                                <button type="submit" class="btn btn-flat"
                                                        data-loading-text="Please wait"
                                                        *ngIf="!signupSubmitting; else loadingContentSignup"
                                                >Sign Up
                                                </button>
                                                <ng-template #loadingContentSignup>
                                                    <button disabled type="button"
                                                            style="color: #333333; font-weight: bold;"
                                                            class="btn btn-flat">
                                                        lease wait
                                                    </button>
                                                </ng-template>
                                            </div>
                                            <div class="d-flex col-md-12 justify-content-around">
                                                <p>
                                                    Already have an account?
                                                    <a title="Sign In"
                                                       (click)="register =false; showVerifyModal = false;"
                                                       style="color: red">Sign
                                                        In</a>
                                                </p>
                                                <p>
                                                    Verify OTP?
                                                    <a title="Verify"
                                                       (click)="register =false; showVerifyModal = true;"
                                                       style="color: red">Verify
                                                    </a>
                                                </p>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </section>
                    </ng-container>

                    <!--verify OTP-->
                    <ng-container *ngIf="!register && !isForgot && showVerifyModal">
                        <section style="padding: 0;">
                            <div class="col-md-12">
                                <div class="mb-3 mx-lg-auto w-25">
                                    <img src="assets/images/logo.png" alt="Logo">
                                </div>
                                <h4 class="signup-title">Verify OTP</h4>

                                <p class="number-verify-text">Anonder Bazar has sent you a 6-digit
                                    verification code</p>
                                <div *ngIf="showTimerCounter === 'processing'"
                                     style="margin: 20px 0; text-align: center"
                                     class="jumbotron">
                                    <h2 style="margin-bottom: 20px">Got the <span style="font-weight: 700;"> OTP</span>
                                    </h2>
                                    <span style="cursor: pointer; margin-right: 10px"
                                          (click)="showTimerCounter = 'yes'; startTimer()"
                                          class="btn btn-success"> Yes</span>
                                    <span style="cursor: pointer" (click)="showTimerCounter = 'no'"
                                          class="btn btn-warning"> No</span>
                                </div>


                                <ng-container *ngIf="showTimerCounter === 'yes'">
                                    <div class="signup-form">
                                        <form class="form-horizontal m-t-50" [formGroup]="verifyOTPForm"
                                              (ngSubmit)="verifyOTP()">
                                            <label for="OTPCode" class="control-label">Enter verification
                                                code</label>
                                            <input placeholder="" class="form-control" id="OTPCode"
                                                   formControlName="OTPCode" [autofocus]="true" required>
                                            <!--<i class='fa fa-check-circle-o feedback-icon-success'></i>
                                            <i class='fa fa-exclamation-circle feedback-icon-error'></i>-->
                                            <mat-error
                                                    *ngIf="verifyOTPForm.controls.OTPCode.touched && verifyOTPForm.controls.OTPCode.invalid">
                                                <mat-error
                                                        *ngIf="verifyOTPForm.controls.OTPCode.errors.required"
                                                        style="font-size: 15px">Verification code is required
                                                </mat-error>
                                            </mat-error>
                                            <!--buttons-->
                                            <div class="row m-0">
                                                <div class="form-group signupbtn pl-0 mt-3">
                                                    <button type="submit" class="btn btn-flat"
                                                            data-loading-text="Please wait">
                                                        VERIFY
                                                    </button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>

                                    <h6 class="mt-4">Verify your code within
                                        <span class="mx-3"
                                              style="font-size: 42px; color: red">{{ timer$ | async | timer}}</span>
                                        minutes
                                    </h6>

                                    <div *ngIf="!isResendForm; else resendButtonClicked" class="mt-4">
                                        <button (click)="showResendForm();"
                                                type="submit" class="resendButton"
                                                style="font-size: 14px;padding: 10px 39px"
                                                data-loading-text="Please wait">
                                            Re-send Code
                                        </button>
                                    </div>

                                </ng-container>

                                <ng-template #resendButtonClicked>
                                    <div class="signup-form">
                                        <form class="form-horizontal m-t-50" [formGroup]="resendOTPForm"
                                              (ngSubmit)="resendOTPCode();">
                                            <label for="OTPCodelebel" class="control-label">Enter your registered phone
                                                number</label>
                                            <input placeholder="Registered Phone Number" class="form-control"
                                                   id="OTPCodelebel"
                                                   formControlName="userPhnNumber" [autofocus]="true" required>
                                            <mat-error *ngIf="resendOTPForm.controls.userPhnNumber.touched && resendOTPForm.controls.userPhnNumber.invalid">
                                                <mat-error
                                                        *ngIf="resendOTPForm.controls.userPhnNumber.errors.required"
                                                        style="font-size: 15px">Please enter your registered phone
                                                    number
                                                </mat-error>
                                                <mat-error
                                                        *ngIf="resendOTPForm.controls.userPhnNumber.errors.phoneNumber"
                                                        style="font-size: 15px">Enter Correct phone number
                                                </mat-error>

                                            </mat-error>
                                            <!--buttons-->
                                            <div class="row m-0">
                                                <div class="form-group signupbtn pl-0 mt-3">
                                                    <button
                                                            type="submit" class="resendButton"
                                                            style="font-size: 14px;padding: 10px 39px"
                                                            data-loading-text="Please wait">
                                                        Re-send Code
                                                    </button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </ng-template>

                                <ng-container *ngIf="showTimerCounter === 'no'">
                                    <div class="jumbotron">
                                        <div *ngIf="!isResendForm; else resendButtonClicked">
                                            <p style="font-size: 16px">Please <b>wait for a while</b> before you click the 'Re-send Code' button</p>
                                            <button (click)="showResendForm();"
                                                    type="submit" class="resendButton mt-4"
                                                    style="font-size: 14px;padding: 10px 39px; text-align: center"
                                                    data-loading-text="Please wait">
                                                Re-send Code
                                            </button>
                                        </div>
                                    </div>
                                </ng-container>

                                <div class="col-md-12 my-3 d-flex">
                                    <p>
                                        Already have an account?
                                        <a title="Sign In" (click)="register =false; showVerifyModal = false;"
                                           style="color: red">Sign
                                            In</a>
                                    </p>
                                    <p>
                                        Create Another account?
                                        <a class="btn-link" style="color: red" (click)="showSignUp()">
                                            Sign Up
                                        </a>
                                    </p>
                                </div>

                            </div>
                        </section>
                    </ng-container>

                    <!--forgot password page-->
                    <ng-container *ngIf="isForgot">
                        <section id="signup-section" style="padding: 0;">
                            <div class="col-md-12">
                                <div class="mb-3 mx-lg-auto w-25">
                                    <img src="assets/images/logo.png" alt="Logo">
                                </div>
                                <h4 class="signup-title">Forgot Password</h4>
                                <div *ngIf="loginErrorMessage" class="alert alert-danger text-center text-capitalize"
                                     role="alert">
                                    {{loginErrorMessage}}
                                </div>
                                <div class="signup-form">
                                    <form class="form-horizontal m-t-50" [formGroup]="validateForgotForm"
                                          (ngSubmit)="submitForgotPasswordForm($event,validateForgotForm.value)">
                                        <div class="row">
                                            <div class="form-group w-100"
                                                 [ngClass]="{ 'has-success':getForgotFormControl('email').dirty }">
                                                <label for="email" class="col-lg-12 control-label">Email</label>
                                                <div class="col-lg-12">
                                                    <input placeholder="Enter Your Email" class="form-control"
                                                           id="email"
                                                           formControlName="email" [autofocus]="true">
                                                    <i class='fa fa-check-circle-o feedback-icon-success'></i>
                                                    <i class='fa fa-exclamation-circle feedback-icon-error'></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="form-group w-100"
                                                 [ngClass]="{'has-error': getForgotFormControl('phone').dirty && getForgotFormControl('phone').hasError('required'), 'has-success':getForgotFormControl('phone').dirty&&!getForgotFormControl('phone').hasError('required') }">
                                                <label for="phone-forget-password"
                                                       class="col-lg-12 control-label">Phone <span
                                                        class="required">*</span></label>
                                                <div class="col-lg-12">
                                                    <input placeholder="Enter Phone Number" class="form-control"
                                                           id="phone-forget-password"
                                                           formControlName="phone" required>
                                                    <i class='fa fa-check-circle-o feedback-icon-success'></i>
                                                    <i class='fa fa-exclamation-circle feedback-icon-error'></i>
                                                    <div class="validation-feedback">
                                                        <span> <i class='fa fa-exclamation-circle'></i> Enter Phone Number </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group signupbtn col-md-12">
                                                <input id="form_botcheck" name="form_botcheck" class="form-control"
                                                       type="hidden" value="">
                                                <button *ngIf="!forgetPaswordSubmitting; else loadingContentForgetPass"
                                                        type="submit" class="btn btn-flat">Send
                                                </button>
                                                <ng-template #loadingContentForgetPass>
                                                    <button disabled type="button"
                                                            style="color: #333333; font-weight: bold;"
                                                            class="btn btn-flat">
                                                        Please Wait
                                                    </button>
                                                </ng-template>
                                                <p>
                                                    Create an account? <a class="btn-link" style="color: red;"
                                                                          (click)="showLogin()">Sign In</a>
                                                </p>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </section>
                    </ng-container>
                </div>
                <!--body section ends-->

                <div class="col-md-12 col-xs-12"></div>
                <section style="padding: 0;">
                    <div class="row"
                         style="background-position: center;  background-repeat: no-repeat; background-size: cover; ">
                    </div>
                </section>
            </div>
        </div>
    </div>
</div>
