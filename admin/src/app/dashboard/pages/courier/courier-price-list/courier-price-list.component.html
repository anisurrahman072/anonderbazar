<section>
    <nz-card class="card-height">
        <ng-template #title>
            Courier Price List
        </ng-template>
        <ng-template #extra>
            <button *ngIf="'courier-price-create'|accessControl" nz-button [nzType]="'primary'" (click)="showModal()" [nzSize]="'large'">
                <i class="anticon anticon-download"></i>
                <span> Add Courier Price </span>
            </button>
        </ng-template>
        <ng-template #body>
            <nz-spin [nzSpinning]="_isSpinning">
                <div class="table-operations">
                </div>
                <nz-table [nzTotal]="total" [nzIsPagination]="false" #nzTable [nzDataSource]="data" [nzPageSize]="limit"
                    [nzSize]="'middle'" [nzShowTitle]="true">
                    <thead nz-thead>
                        <tr>
                            <th nz-th>
                                <span> Courier</span>
                            </th>
                            <th nz-th>
                                <span> Weight </span>
                            </th>
                            <th nz-th>
                                <span>Price</span>
                            </th>
                            <th nz-th>
                                <span>Details</span>
                            </th>
                            <th nz-th>
                                <span>Actions</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody nz-tbody>
                        <ng-template ngFor let-data let-i="index" [ngForOf]="nzTable.data">
                            <tr nz-tbody-tr>

                                <td nz-td>
                                    {{data.id}}  /
                                    {{data.courier_id?.name}}
                                </td>
                                <td nz-td>
                                    {{data.weight}}
                                </td>
                                <td nz-td>
                                    <nz-tag>{{data.price}}</nz-tag>
                                </td>
                                <td nz-td>
                                    <nz-tag>{{data.remarks}}</nz-tag>
                                </td>
                                <td>
                                    <nz-button-group>
                                        <button *ngIf="'courier-price-edit'|accessControl" (click)="showEditModal(data.id)"
                                            nz-button [nzType]="'primary'" [nzSize]="'default'">
                                            <i class="anticon anticon-edit"></i>
                                        </button>
                                        <ng-container *ngIf="'courier-price-delete'|accessControl">
                                            <nz-popconfirm [nzTitle]="'Are you sure you want to delete?'" [nzOkText]="'Delete'"
                                                [nzCancelText]="'Cancel'" (nzOnConfirm)="deleteConfirm(i, data.id)">
                                                <a nz-popconfirm>
                                                    <button nz-button [nzType]="'danger'" [nzSize]="'default'">
                                                        <i class="anticon anticon-delete "></i>
                                                    </button>
                                                </a>
                                            </nz-popconfirm>
                                        </ng-container>
                                    </nz-button-group>
                                </td>
                            </tr>
                        </ng-template>
                    </tbody>
                </nz-table>
            </nz-spin>
            <div class="row">
                <div class="col-md-offset-5" style="margin-top: 10px">
                    <span nz-table-title class="col-md-6">
                        <nz-pagination (nzPageIndexClickChange)="changePage($event,limit)" (nzPageSizeChange)="changePage(1,$event)"
                            nzShowTotal [nzPageIndex]="page" [nzTotal]="total" nzShowSizeChanger [nzPageSize]="limit">
                        </nz-pagination>
                    </span>
                    <span nz-table-title class="pull-right col-md-6">
                        <button nz-button (click)="resetAllFilter()">Clear filter</button>
                    </span>
                </div>
            </div>
        </ng-template>
    </nz-card>
</section>

<nz-modal [nzFooter]="null" [nzVisible]="isVisible" [nzTitle]="modalTitle" [nzContent]="modalContent"
(nzOnCancel)="handleCancel($event)">
    <ng-template #modalTitle>
        Add Courier Price
    </ng-template>
    <ng-template #modalContent>
        <div class="row">
            <form nz-form [formGroup]="validateForm" id="validateForm" (ngSubmit)="submitForm($event,validateForm.value)">
                <div class="col-md-12">
                    <div nz-form-item nz-row>
                        <div nz-col [nzSpan]="4" nz-form-label>
                            <label>
                                Courier
                            </label>
                        </div>
                        <div nz-col [nzSpan]="12" nz-form-control nzHasFeedback>
                            <nz-select formControlName="courier_id" nzMaxMultipleCount="3" style="width: 100%"
                                nzPlaceHolder="Select courier">
                                <nz-option *ngFor="let courier of listOfCourier" [nzLabel]="courier.name" [nzValue]="courier.id"></nz-option>
                            </nz-select>
                            <div nz-form-explain *ngIf="getFormControl('courier_id').dirty&&getFormControl('courier_id').hasError('required')">
                                Please select !
                            </div>
                        </div>
                    </div>
                    <!--courier-->
                    <div nz-form-item nz-row>
                        <div nz-form-label nz-col [nzSpan]="4">
                            <label> Weight </label>
                        </div>
                        <div nz-col [nzSpan]="12" nz-form-control nzHasFeedback>
                            <nz-input formControlName="name" [nzType]="'text'" [nzPlaceHolder]="'Enter Weight'"
                                [nzSize]="'large'">
                            </nz-input>
                            <div nz-form-explain *ngIf="getFormControl('name').dirty&&getFormControl('name').hasError('required')">
                                Please enter weight!
                            </div>
                            <div nz-form-explain *ngIf="getFormControl('name').dirty&&getFormControl('name').hasError('duplicated')">
                                The weight is already inserted.
                            </div>
                            <div nz-form-explain *ngIf="getFormControl('name').dirty&&getFormControl('name').pending">
                                Verifying ...
                            </div>
                        </div>
                    </div>
                    <!-- name -->
                    <div nz-form-item nz-row>
                        <div nz-form-label nz-col [nzSpan]="4">
                            <label> Price </label>
                        </div>
                        <div nz-col [nzSpan]="12" nz-form-control nzHasFeedback>
                            <nz-input formControlName="price" [nzType]="'number'" [nzPlaceHolder]="'Please enter Price'"
                                [nzSize]="'large'">
                            </nz-input>
                            <div nz-form-explain *ngIf="getFormControl('price').dirty&&getFormControl('price').hasError('required')">
                                Please enter Price!
                            </div>
                        </div>
                    </div>
                    <!-- price -->
                    <div nz-form-item nz-row>
                        <div nz-col [nzSpan]="4" nz-form-label>
                            <label> Details </label>
                        </div>
                        <div nz-col [nzSpan]="12" nz-form-control nzHasFeedback>
                            <textarea nz-input formControlName="remarks" [nzSize]="'large'" placeholder="Write the details">
                                                </textarea>
                            <div nz-form-explain *ngIf="getFormControl('remarks').dirty&&getFormControl('remarks').hasError('required')">
                                required!
                            </div>
                        </div>
                    </div>
                    <!-- remarks -->
                    <div nz-form-item nz-row>
                        <div nz-col [nzSpan]="4" nz-form-label>
                        </div>
                        <div nz-col [nzSpan]="12" nz-form-control nzHasFeedback>
                            <nz-button-group>
                                <button nz-button type="button" [nzSize]="'large'" (click)="handleCancel($event)">
                                    Cancel
                                </button>
                                <button nz-button [nzType]="'primary'" [nzSize]="'large'" [nzLoading]="isConfirmLoading">
                                    Save
                                </button>
                            </nz-button-group>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </ng-template>
</nz-modal>

<nz-modal [nzFooter]="null" [nzVisible]="isEditVisible" [nzTitle]="modalTitleEdit" [nzContent]="modalContentEdit"
    (nzOnCancel)="handleEditCancel($event)">
    <ng-template #modalTitleEdit>
        Courier Price Edit
    </ng-template>
    <ng-template #modalContentEdit>
        <div class="row">
            <form nz-form [formGroup]="validateEditForm" id="validateEditForm" (ngSubmit)="submitEditForm($event,validateEditForm.value)">
                <div class="col-md-12">
                    <div nz-form-item nz-row>
                        <div nz-col [nzSpan]="4" nz-form-label>
                            <label>
                                Courier
                            </label>
                        </div>
                        <div nz-col [nzSpan]="12" nz-form-control nzHasFeedback>
                            <nz-select formControlName="editCourier_id" style="width: 100%" nzPlaceHolder="Select courier">
                                <nz-option *ngFor="let courier of listOfCourier" [nzLabel]="courier.name" [nzValue]="courier.id"></nz-option>
                            </nz-select>
                            <div nz-form-explain *ngIf="getEditFormControl('editCourier_id').dirty&&getEditFormControl('editCourier_id').hasError('required')">
                                Please select !
                            </div>
                        </div>
                    </div>
                    <!--courier-->
                    <div nz-form-item nz-row>
                        <div nz-form-label nz-col [nzSpan]="4">
                            <label> Weight </label>
                        </div>
                        <div nz-col [nzSpan]="12" nz-form-control nzHasFeedback>
                            <nz-input formControlName="editName" [nzType]="'text'" [ngModel]="editName" [nzPlaceHolder]="'ওজন লিপিবদ্ধ করুন'"
                                [nzSize]="'large'">
                            </nz-input>
                            <div nz-form-explain *ngIf="getEditFormControl('editName').dirty&&getEditFormControl('editName').hasError('required')">
                                Please enter weight!
                            </div>
                            <div nz-form-explain *ngIf="getEditFormControl('editName').dirty&&getEditFormControl('editName').hasError('duplicated')">
                                The weight is already inserted.
                            </div>
                            <div nz-form-explain *ngIf="getEditFormControl('editName').dirty&&getEditFormControl('editName').pending">
                                Verifying ...
                            </div>
                        </div>
                    </div>
                    <!-- name -->
                    <div nz-form-item nz-row>
                        <div nz-form-label nz-col [nzSpan]="4">
                            <label> Price </label>
                        </div>
                        <div nz-col [nzSpan]="12" nz-form-control nzHasFeedback>
                            <nz-input formControlName="editPrice" [nzType]="'number'" [ngModel]="editPrice"
                                [nzPlaceHolder]="'Please enter Price'" [nzSize]="'large'">
                            </nz-input>
                            <div nz-form-explain *ngIf="getEditFormControl('editPrice').dirty&&getEditFormControl('editPrice').hasError('required')">
                                Please enter Price!
                            </div>
                        </div>
                    </div>
                    <!-- price -->
                    <div nz-form-item nz-row>
                        <div nz-col [nzSpan]="4" nz-form-label>
                            <label> Details </label>
                        </div>
                        <div nz-col [nzSpan]="12" nz-form-control nzHasFeedback>
                            <textarea nz-input formControlName="editRemarks" [ngModel]="editRemarks" [nzSize]="'large'"
                                placeholder="Write the Details">
                            </textarea>
                            <!-- <div nz-form-explain *ngIf="getEditFormControl('editRemarks').dirty&&getEditFormControl('editRemarks').hasError('required')">
                                required!
                            </div> -->
                        </div>
                    </div>
                    <!-- remarks -->
                    <div nz-form-item nz-row>
                        <div nz-col [nzSpan]="4" nz-form-label>
                        </div>
                        <div nz-col [nzSpan]="12" nz-form-control nzHasFeedback>
                            <nz-button-group>
                                <button nz-button type="button" [nzSize]="'large'" (click)="handleEditCancel($event)">
                                    Cancel
                                </button>
                                <button nz-button [nzType]="'primary'" [nzSize]="'large'" [nzLoading]="isConfirmLoading">
                                    Save
                                </button>
                            </nz-button-group>
                        </div>
                    </div>
                </div>
            </form>
        </div>

    </ng-template>
</nz-modal>
